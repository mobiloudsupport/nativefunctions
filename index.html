<html>
<head>
	<script type="text/javascript"> 
		// Check if the user agent matches the app's user agent
		const isApp = navigator.userAgent.toLowerCase().indexOf('canvas') > -1;

		// Add the event listener that will trigger once the native functions are ready to be used
		window.addEventListener("message", (event) => {
			runNativeFunctions(event);
		}, false);
		
		// Run when the event listener is triggered
		function runNativeFunctions(event) {
			try {
				if (isApp) {
					
					if (event.data && event.data == 'nativeFunctionsLoaded') {
					
						// Set the external user ID
						let externalUserId = 1;
						
						if (window.nativeFunctions != undefined) {
							nativeFunctions.onesignalSetExternalUserId(extid);
							doesWork.innerHTML = "yes, the native function triggered successfully";
						} else {
							doesWork.innerHTML = "no, window.nativeFunctions is undefined";
						}
						
					}
				}	
			} catch (ex) {
			
				var span = document.getElementById('response');
				span.textContent = 'Error: ' + ex.message;
				console.log(span.textContent);
				doesWork.innerHTML = "no, something went wrong";
				
			}
			
		}
	</script>
</head>
<body>
 
	<h3>Are native functions working?</h1>
	<h3 class="doesWork">No</h1>
	
</body>
</html>